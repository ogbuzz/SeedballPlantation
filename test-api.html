<!DOCTYPE html>
<html>
<head>
    <title>Test API CouchDB</title>
</head>
<body>
    <h1>Test API CouchDB</h1>
    <button onclick="testAPI()">Tester la connexion</button>
    <pre id="result"></pre>

    <script src="https://cdn.jsdelivr.net/npm/pouchdb@8.0.1/dist/pouchdb.min.js"></script>
    <script>
        async function testAPI() {
            const result = document.getElementById('result');
            result.textContent = 'Test en cours...\n';

            try {
                // Test 1: Acc√®s direct API
                result.textContent += '\n1. Test API REST...\n';
                const response = await fetch('/seedballs');
                const data = await response.json();
                result.textContent += '‚úÖ API accessible: ' + data.db_name + '\n';

                // Test 2: PouchDB sync
                result.textContent += '\n2. Test PouchDB...\n';
                const db = new PouchDB('/seedballs');
                const info = await db.info();
                result.textContent += '‚úÖ PouchDB connect√©: ' + info.doc_count + ' documents\n';

                // Test 3: √âcriture
                result.textContent += '\n3. Test √©criture...\n';
                const doc = await db.put({
                    _id: 'test-' + Date.now(),
                    type: 'test',
                    message: 'Hello from WHC.ca!'
                });
                result.textContent += '‚úÖ Document cr√©√©: ' + doc.id + '\n';

                result.textContent += '\nüéâ TOUS LES TESTS R√âUSSIS!\n';
            } catch (error) {
                result.textContent += '\n‚ùå ERREUR: ' + error.message + '\n';
                console.error(error);
            }
        }
    </script>
</body>
</html>
